<ndm-page
    class="page-kvas-ui"
    label="KVAS UI"
    progress="vm.progress"
    description=" "
>
    <br/>
    <ndm-details
        label-visible="{{ vm.l10n.backendSettings.hide }}"
        label-hidden="{{ vm.l10n.backendSettings.show }}"
        toggle-var="vm.foo"
    >
        <form
            class="backend-settings"
            name="vm.settingsForm"
        >
            <ndm-input
                name="kvasBackendAddress"
                label="{{ vm.l10n.backend.address }}"
                model="vm.backendConnection.data.address"
                validation="address"
                max-length="256"
            >
            </ndm-input>

            <ndm-input
                name="kvasBackendUsername"
                label="{{ vm.l10n.backend.username }}"
                model="vm.backendConnection.data.username"
                validation="login"
            >
            </ndm-input>

            <ndm-input
                name="kvasBackendPassword"
                label="{{ vm.l10n.backend.password }}"
                model="vm.backendConnection.data.password"
                password="true"
                validation="password"
            >
            </ndm-input>

            <ndm-button
                is-disabled="!vm.backendConnection.data.address"
                on-click="vm.testBackendConnection"
                label="{{ vm.l10n.backend.testConnectionBtn }}"
            >
            </ndm-button>
        </form>
    </ndm-details>

    <br/>

    <ndm-details
        label-visible="{{ 'Show latest response' }}"
        label-hidden="{{ 'Hide latest response' }}"
        toggle-var="vm.ui.isDebugBlockExpanded"
    >
        <pre>
            {{ vm.latestResponse | json }}
        </pre>
    </ndm-details>

    <br/>
    <br/>

    <div class="page-kvas-ui__unblock-list unblock-list">
        <div class="unblock-list__toolbar">
            <ndm-button
                on-click="vm.refreshUnblockList"
                is-disabled="vm.ui.isLocked"
                label="{{ vm.l10n.unblockList.refresh }}"
            >
            </ndm-button>

            <ndm-button
                on-click="vm.addHostToUnblockList"
                is-disabled="vm.ui.isLocked"
                label="{{ vm.l10n.unblockList.addHost }}"
            >
            </ndm-button>
        </div>

        <br/>

        <div
            ng-form="vm.unblockListForm"
            class="unblock-list"
        >
            <div
                ng-repeat="item in vm.unblockList.list track by $index"
                class="unblock-list__item list-item"
            >
                <ndm-input
                    class="list-item__input"
                    name="unblockListItem{{$index}}"
                    disabled="vm.ui.isLocked"
                    model="item"
                >
                </ndm-input>

                <div class="list-item__toolbar">
                    <ndm-button
                        ng-click="vm.removeHostFromUnblockList($index)"
                        is-disabled="vm.ui.isLocked"
                        label="{{ vm.l10n.unblockList.removeHost }}"
                    >
                    </ndm-button>
                </div>
            </div>
        </div>
    </div>

    <div
        ng-if="vm.footer.isVisible"
        class="page-kvas-ui__footer"
    >
        <ndm-button
            on-click="vm.footer.save"
            btn-class="btn--primary"
            is-disabled="vm.ui.isLocked || vm.footer.isLocked"
            label="save"
        >
        </ndm-button>

        <ndm-button
            on-click="vm.footer.reset"
            is-disabled="vm.ui.isLocked || vm.footer.isLocked"
            label="cancel"
        >
        </ndm-button>
    </div>

</ndm-page>